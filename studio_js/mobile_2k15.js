var Mobile=Mobile||{};(function(window,Mobile,jq,hammer){"use strict";var selector,drawer,drawerMask;var buttonContainer,buttonSetA,buttonSetB;var Drawer={visible:false,expand:false,init:function(drawerSelector){selector=drawerSelector;drawer=jq(drawerSelector);drawerMask=jq(drawerSelector+"_mask");buttonContainer=jq(drawerSelector+"_more");buttonSetA=buttonContainer.children("li:lt(4)");buttonSetB=buttonContainer.children("li:gt(3)");buttonContainer.addClass(drawerSelector.substring(1)+"_moreA");buttonSetB.hide();drawerMask.on("click",function(event){event.preventDefault();Drawer.close()});jq(window).on("popstate",function(event){if(Drawer.visible){Drawer.close()}});delete Hammer.defaults.cssProps.userSelect;hammer(window.document.body).on("swipeleft",function(event){Drawer.close()})},toggle:function(){Drawer.visible?Drawer.close():Drawer.open()},open:function(){drawer.css("left","0");drawerMask.show();Drawer.visible=true;jq("body").css("overflow","hidden");if(window.location.hash!="#drawer"){window.history.pushState({},"","#drawer")}},close:function(){drawer.css("left","-95%");drawerMask.hide();Drawer.visible=false;jq("body").css("overflow","");if(window.location.hash=="#drawer"){window.history.back()}},moreButton:function(){Drawer.expand=true;buttonSetA.hide();buttonContainer.removeClass(selector.substring(1)+"_moreA").addClass(selector.substring(1)+"_moreB");buttonSetB.fadeIn()},INDEX_MIXLIST:0,INDEX_HOTTOPIC:1,INDEX_HOTGAME:2,INDEX_INDEX:3,INDEX_GNN:4,INDEX_FORUM:5,INDEX_ANIME:6,INDEX_HOME:7,INDEX_GUILD:8,INDEX_GAMELIVE:9,INDEX_USERS:10,INDEX_APPS:11,setCurrentMenu:function(index){var currentClass=selector+"_listNow";jq(currentClass).removeClass(currentClass.substring(1));jq(selector+"_list a:eq("+index+")").addClass(currentClass.substring(1))}};Mobile.NavigationDrawer=Drawer})(window,Mobile,jQuery,Hammer);(function(window,Cookies,undefined){function bahadata(element,opts){return this instanceof bahadata?this.init(element,opts):new bahadata(element,opts)}function storagesupported(){try{localStorage.setItem("testsupport",1);localStorage.removeItem("testsupport");return true}catch(err){return false}}bahadata.prototype.init=function(element,opts){};bahadata.prototype.get=function(name){if(storagesupported()){return localStorage.getItem(name)}else{return Cookies.get(name)||""}};bahadata.prototype.set=function(name,value){if(storagesupported()){return localStorage.setItem(name,value)}else{return Cookies.set(name,value)}};bahadata.prototype.del=function(name){if(storagesupported()){return localStorage.removeItem(name)}else{return Cookies.remove(name)}};if(typeof exports=="object"){module.exports=bahadata}else if(typeof define=="function"&&define.amd){define(function(){return bahadata})}else{window.bahadata=bahadata}})(window,Cookies);(function(Mobile,$){"use strict";var Gnn={};function post_comment(button,sn,token,content){$.ajax({url:"/ajax/MB_gnn_comment_2k14.php",param:"token="+token+"&sn="+sn+"&cont="+encodeURIComponent(content),method:"POST",success:function(response){if("1__"==response.substr(0,3)){alert(response.substr(3));return}$("#gnnComment").val("");if(button){button.disabled=false}var commentNode=document.createElement("li");$(commentNode).html(response);var container=document.getElementById("commentContainer");if(document.getElementById("commentTip")){container.removeChild(document.getElementById("commentTip"))}container.appendChild(commentNode);$("#commentCount").html(container.childNodes.length);Mobile.Forum.commentFormatter(jQuery(".comment_text"))}})}Gnn.comment=function(button,sn,token){var content=$("#gnnComment").val();if(content.length===0){Dialogify.alert("請輸入留言內容");return}if(Util.String.utf8Length(content)>150){Dialogify.alert("限 50 個中文字喔!");return}if(button){button.disabled=true}Dialogify.confirm("★ 毀謗屬刑事案件 (會留下前科)，敬告發表者自負法律責任。 →了解更多<br>★ 良性批評可。無關或含有惡意批評文字、影射、歧視、諧音等留言將會刪除。<br>★ 巴哈姆特全權決定刪除標準，累犯者將永久取消新聞留言資格，並視情況全站禁貼處分。",{ok:function(){post_comment(button,sn,token,content)},cancel:function(){if(button){button.disabled=false}}})};function post_accuse(sn,userid,g,ar){if(g<1||g>7){Dialogify.alert("檢舉理由錯誤");return false}if(g!=7){var ar=jQuery("#areason :selected").text()}if(ar==""||ar=="（請輸入 50 字內之說明）"||ar=="-請選擇理由-"||ar.replace(/ |　/g,"")==""){Dialogify.alert("請提供檢舉理由");return false}if(ar.length>50){Dialogify.alert("字數超過50");return false}Dialogify.confirm("確定送出檢舉？",{ok:function(){MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_gnn_accuse_comment.php",data:{sn:sn,userid:userid,g:g,ar:ar,token:token},cache:false,type:"POST",dataType:"json"}).done(function(json){if(json.code){Dialogify.alert(json.message)}else{Dialogify.alert("檢舉成功")}})})},cancel:function(){return false}})}Gnn.accuse_comment=function(sn,userid){jQuery(".more_tool_box").css("display","none");new Dialogify("#accuse_reason").title("檢舉留言").buttons([{text:"取消",click:function(e){this.close()}},{text:"確定",type:Dialogify.BUTTON_PRIMARY,click:function(e){post_accuse(sn,userid,this.$content.find("select.text-field").val(),this.$content.find("textarea.text-field").val());this.close()}}]).showModal()};Mobile.Gnn=Gnn})(Mobile,egg);(function(Mobile,egg,$){"use strict";var ForumM={};ForumM.insertImageDialog=function(){egg.lightbox.close();var content="";content+='<div class="bala_post">';content+='<i class="fa fa-times-circle" onclick="egg.lightbox.close()"></i>';content+="<ul>";content+='<li><a href="javascript:;" onclick="Mobile.Forum.insertImageDialog.fileLayout();" class="now">上傳圖片</a></li>';content+='<li><a href="javascript:;" onclick="Mobile.Forum.insertImageDialog.truthLayout();">小屋圖片</a></li>';content+='<li><a href="javascript:;" onclick="Mobile.Forum.insertImageDialog.urlLayout();">圖片網址</a></li>';content+="</ul>";content+='<div class="bala_post_main">';content+="</div>";content+="</div>";var bodyHeight=document.documentElement.clientHeight||document.body.clientHeight||0;var lightboxHeight=bodyHeight*.8;var config={css:{width:"100%",height:lightboxHeight+"px","text-align":"left","z-index":"101",top:"120"}};egg.lightbox(content,config);egg.lightbox.refresh();egg("#egg_mask").css("z-index",100);egg(".bala_post_main").css({height:egg("#egg_box").get(0).clientHeight-84+"px","overflow-y":"auto"});ForumM.insertImageDialog.fileLayout()};ForumM.insertImageDialog.insertImage=function(images){var pattern=/(^http[s]?:\/\/(?:.*?)\.(?:jpg|jpeg|gif|png))(?:\?[^\?]*)?$/i;var patternPchome=/^http:\/\/link\.photo\.pchome\.com\.tw\/s[0-9]{1,3}\/[a-zA-Z0-9\_]{4,16}\/[0-9]{1,4}\/[0-9]{10,15}\/$/i;if(!Array.isArray(images)){images=[images]}var result="";var hasHttpUrl=false;for(var index in images){var imageUrl=images[index];imageUrl=Util.HttpImgFilter.forceToHttps(imageUrl);if(!imageUrl){alert("這個圖床不支援 https 唷!");hasHttpUrl=true;continue}if(imageUrl.match(pattern)||imageUrl.match(patternPchome)){result+="[img="+imageUrl+"]";if(index!=images.length-1){result+="\n"}}}if(hasHttpUrl){return}var textarea=egg("[name=rtecontent]").get(0);var startPos=textarea.selectionStart;var start=textarea.value.substring(0,startPos);var end=textarea.value.substring(textarea.selectionEnd);textarea.value=start+result+end;textarea.selectionStart=startPos;textarea.selectionEnd=startPos+result.length;egg.lightbox.close();textarea.focus()};ForumM.insertImageDialog.urlLayout=function(){var tabs=egg(".bala_post > ul > li > a").each(function(elem){elem.removeAttribute("class")}).filter(":eq(2)").get(0).className="now";var content="";content+='<input class="halaCpop_url" id="image_url" type="text" placeholder="https://">';content+='<p style="text-align:center;">因應安全性，即日起只支援 https 的圖床</p>';content+='<p class="halaCpop_btns"><input type="button" value="取消" onclick="egg.lightbox.close();">';content+='<input type="button" value="送出" onclick="Mobile.Forum.insertImageDialog.insertImage(egg(\'#image_url\').val());"></p>';egg(".bala_post_main").html(content)};ForumM.insertImageDialog.truthLayout=function(page){var tabs=egg(".bala_post > ul > li > a").each(function(elem){elem.removeAttribute("class")}).filter(":eq(1)").get(0).className="now";page=page||1;if(page==1){egg(".bala_post_main").html("")}egg.ajax({url:"/ajax/MB_gettruthimg.php",param:"p="+page,method:"GET",success:function(rdata){if(!rdata){return}var json=JSON.parse(rdata);if(json.error){alert(json.error);return}if(page==1){var html="";if(!json.length){html='<div style="text-align:center;">圖片空間裡沒有圖片</div>'}else{var containerHeight=egg(".bala_post_main").get(0).clientHeight-70;html='<div data-page="'+page+'" onscroll="Mobile.Forum.insertImageDialog.moreTruthImage(event, this);" style="height:'+containerHeight+'px;overflow-y:scroll;" id="truth_image_container"></div>';html+='<p class="halaCpop_btns" style="margin-bottom:0;"><input type="button" value="取消" onclick="egg.lightbox.close();">';html+='<input type="button" value="送出" onclick="Mobile.Forum.insertImageDialog.insertSelectedTruthImage();"></p>'}egg(".bala_post_main").html(html)}var container=document.getElementById("truth_image_container");if(!json.length){container.removeAttribute("onscroll");return}for(var key in json){var html='<input type="checkbox" name="truth_image" value="'+json[key].code+'">';html+="\n<img onclick=\"Mobile.Forum.insertImageDialog.insertImage('"+json[key].code+'\');" src="'+json[key].pic+'">';var div=document.createElement("div");div.innerHTML=html;container.appendChild(div)}container.setAttribute("data-page",page);container.removeAttribute("data-loading")}})};ForumM.insertImageDialog.fileLayout=function(){var tabs=egg(".bala_post > ul > li > a").each(function(elem){elem.removeAttribute("class")}).filter(":eq(0)").get(0).className="now";var content="";content+='<form style="margin:0px;" id="bhImgForm" method="post" enctype="multipart/form-data" target="hideIframe" action="truthUp.php" onsubmit="return Mobile.Forum.insertImageDialog.validateUpload();">';content+='<div id="uploaddiv">';content+='<input name="upic1" type="file" accept="image/*">';content+='<input name="upic2" type="file" accept="image/*">';content+='<input name="upic3" type="file" accept="image/*">';content+='<p class="halaCpop_btns"><input type="button" value="取消" onclick="egg.lightbox.close();"><input type="submit" value="上傳"></p>';content+='</div><div id="uploadmsg" style="display:none">圖片上傳中，請稍候...</div></form>';content+='<iframe name="hideIframe" id="hideIframe" width="0" height="0"></iframe>';egg(".bala_post_main").html(content)};ForumM.insertImageDialog.validateUpload=function(){var MAX_SIZE=2097152;var empty=true;for(var i=1;i<=3;i++){var elem=egg("[name=upic"+i+"]").get(0);if(elem.value){empty=false;if(elem.files[0].size>MAX_SIZE){alert("選取的圖片大於 2MB 無法上傳");return false}}}if(empty){alert("請選擇圖片");return false}egg("#uploadmsg").show();egg("#uploaddiv").hide();return true};ForumM.insertImageDialog.uploadCallback=function(error,result){egg("#uploadmsg").hide();egg("#uploaddiv").show();if(error){alert(error);return}ForumM.insertImageDialog.insertImage(result)};ForumM.insertImageDialog.insertSelectedTruthImage=function(){var values=egg("#truth_image_container [name=truth_image]:checked").val();if(values){ForumM.insertImageDialog.insertImage(values)}egg.lightbox.close()};ForumM.insertImageDialog.moreTruthImage=function(event,elem){var page=parseInt(elem.getAttribute("data-page"),10);var isLoading=elem.getAttribute("data-loading")=="yes";if(!isLoading&&elem.scrollTop+elem.offsetHeight>=elem.scrollHeight-100&&!isNaN(page)&&page>0){elem.setAttribute("data-loading","yes");page++;ForumM.insertImageDialog.truthLayout(page)}};ForumM.commentFormatter=function(elems){elems=$(elems);elems.each(function(index){var elem=$(this);if(elem.data("formatted")=="yes"){return}var html=elem.parents("[data-comment]").data("comment").content;html=html.replace(/https?:\/\/[!#-&(-;=?-Z\^-~]+/gi,function(url){var youtube=/^https?:\/\/www\.youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})(?:&(t=[hms0-9]+))?/;var sharetube=/^https?:\/\/youtu\.be\/([0-9a-zA-Z_-]{11})(?:\?(t=[hms0-9]+))?/;var facebook=/^https?:\/\/www\.facebook\.com\/(\w+)\/videos\/(\d+)\//;var matches,snippet;if(/^https:\/\/.+?\.(?:jpe?g|gif|png)(?:\?w=[0-9]+)?$/i.test(url)){snippet='<a target="_blank" href="'+url.split("?")[0]+'">';snippet+='<img class="lazyload" data-src="'+url+'"></a>'}else if(matches=url.match(youtube)||url.match(sharetube)){snippet='<a target="_blank" href="https://www.youtube.com/watch?v='+matches[1]+(matches[2]?"&"+matches[2]:"")+'">';snippet+='<img class="video-btn_play" src="https://i2.bahamut.com.tw/icon_videoplayer.svg">';snippet+='<div style="width:120px;height:90px;background-image:url(https://img.youtube.com/vi/'+matches[1]+'/default.jpg);"></div></a>'}else if(matches=url.match(facebook)){snippet='<a target="_blank" href="https://www.facebook.com/'+matches[1]+"/videos/"+matches[2]+'/">';snippet+='<img class="video-btn_play" src="https://i2.bahamut.com.tw/icon_videoplayer.svg">';snippet+='<div style="width:120px;height:90px;background-image:url(https://graph.facebook.com/'+matches[2]+'/picture);background-position: center;"></div></a>'}else{snippet='<a target="_blank" onclick="Mobile.Forum.refurl(this);" href="'+url+'">'+url+"</a>"}return snippet});html=html.replace(/(^|\s+)#([0-9]+)/g,function(match,space,to){var bsn=window.location.search.match(/bsn=([0-9]+)/);var snA=window.location.search.match(/snA=([0-9]+)/);if(bsn&&snA){var replacement=space+'<a href="https://'+window.location.host;replacement+=window.location.pathname;replacement+="?bsn="+bsn[1]+"&snA="+snA[1]+"&to="+to+'">#'+to+"</a>";return replacement}return match});html=html.replace(/\[([a-zA-Z][a-zA-Z0-9]{1,11}):([^\]]*)\]/g,function(tag,userid,nickname){return'<a target="_blank" href="/home/home.php?owner='+userid+'">'+nickname+"</a>"});elem.attr("data-formatted","yes").html(html)})};ForumM.refurl=function(anchor){if(!anchor.href.match(/^https?:\/\/ref\.gamer\.com\.tw/)){anchor.href="https://ref.gamer.com.tw/redir.php?url="+encodeURIComponent(anchor.href)}};ForumM.unfoldComment=function(elem){$(elem).parent().next().show(400).end().remove()};var TOASTRES=[];ForumM.TYPE_GP=1;ForumM.TYPE_BP=2;ForumM.commentGp=function(elem){var data=$(elem).parents(".cbox_msg2_list").data("comment");commentGpBp(elem,ForumM.TYPE_GP,data)};ForumM.commentBp=function(elem){var data=$(elem).parents(".cbox_msg2_list").data("comment");commentGpBp(elem,ForumM.TYPE_BP,data)};ForumM.commentRestoreGpBp=function(bsn,snB,snC){var id=bsn+"_"+snB+"_"+snC;toastr.clear(TOASTRES[id],{force:true});delete TOASTRES[id];MB_getCSRFToken().done(function(token){var params={token:token,bsn:bsn,snB:snB,snC:snC};$.post("/ajax/forum_comment_restore_gpbp.php",params,function(json){if(json.message){toastr.warning(json.message,"",{tapToDismiss:true});return}commentGpBpUpdate(json.type,json.snC,-1);toastr.info("您的動作已復原","",{tapToDismiss:true})})})};ForumM.toggleDisplayImage=function(){if(Cookies.get("ckForumShrinkMedia")=="yes"){Cookies.remove("ckForumShrinkMedia",{domain:"gamer.com.tw"});Forum.Common.expandAll();$(".top_draw").hide().children("a:eq(0)").text("關閉圖片影片")}else{Cookies.set("ckForumShrinkMedia","yes",{expires:365,domain:"gamer.com.tw"});window.location.reload()}};function commentGpBp(button,type,data){if(!Cookies.get("BAHAID")&&!Cookies.get("MB_BAHAID")){location.href="https://user.gamer.com.tw/login.php";return}$(button).prop("disabled",true);MB_getCSRFToken().done(function(token){var params={token:token,bsn:data.bsn,snB:data.snB,snC:data.sn,t:type};$.post("/ajax/forum_comment_gpbp.php",params,function(json){$(button).prop("disabled",false);if(json.message){if(json.code==1){ForumM.commentRestoreGpBp(data.bsn,data.snB,data.sn)}else{toastr.warning(json.message,"",{tapToDismiss:true})}return}var bsn=json.bsn;var snB=json.snB;var snC=json.snC;var type=json.type;var restore="Mobile.Forum.commentRestoreGpBp("+bsn+", "+snB+", "+snC+");";var toastrHtml='<a href="javascript:'+restore+'" style="float:right;color:yellow;">復原</a>';if(type==ForumM.TYPE_GP){toastrHtml="勇者獲得了 1 點能量"+toastrHtml;ga("send","event","互動","哈啦區","留言推")}else{toastrHtml="勇者削弱了 1 點精神"+toastrHtml;ga("send","event","互動","哈啦區","留言噓")}commentGpBpUpdate(type,snC,1);TOASTRES[bsn+"_"+snB+"_"+snC]=toastr.success(toastrHtml,"",{timeOut:1e4})})})}function commentGpBpUpdate(type,snC,diffValue){var dataName=type==ForumM.TYPE_GP?"gp":"bp";var commentElem=$("#Commendcontent_"+snC);var elem=commentElem.find("."+dataName);var value=parseInt(elem.data(dataName),10)||0;value+=diffValue;elem.data(dataName,value);if(type==ForumM.TYPE_GP){var html='<i class="fa fa-thumbs-up"></i>';if(value>0){elem.html(html+value);if(!elem.hasClass("is-highlight")){elem.addClass("is-highlight")}}else{elem.html(html);if(elem.hasClass("is-highlight")){elem.removeClass("is-highlight")}}}else{var html='<i class="fa fa-thumbs-down"></i>';value<5&&elem.html(html)||elem.html(html+value)}}Mobile.Forum=ForumM})(Mobile,egg,jQuery);(function(Mobile,jQuery,undefined){"use strict";var document=window.document,mobileMailbox={sending:false};mobileMailbox.changetxt=function(str){str=str.replace(/https?:\/\/[!#-&(-;=?-Z\^-~]+/gi,function(url){var youtube=/^https?:\/\/www\.youtube\.com\/watch\?v=([0-9a-zA-Z_-]{11})/;var sharetube=/^https?:\/\/youtu\.be\/([0-9a-zA-Z_-]{11})/;var facebook=/^https?:\/\/www\.facebook\.com\/(\w+)\/videos\/(\d+)\//;var matches,snippet,urlDecoded;if(/^https:\/\/.+?\.(?:jpe?g|gif|png)$/i.test(url)){snippet='<a target="_blank" href="'+url+'">';snippet+='<img src="'+url+'"></a>'}else if(matches=url.match(youtube)||url.match(sharetube)){snippet='<a class="cbox_video_link" target="_blank" href="https://www.youtube.com/watch?v='+matches[1]+'">';snippet+='<img class="video-btn_play" src="https://i2.bahamut.com.tw/icon_videoplayer.svg">';snippet+='<img src="https://img.youtube.com/vi/'+matches[1]+'/hqdefault.jpg"></a>'}else if(matches=url.match(facebook)){snippet='<a class="cbox_video_link" target="_blank" href="https://www.facebook.com/'+matches[1]+"/videos/"+matches[2]+'/">';snippet+='<img class="video-btn_play" src="https://i2.bahamut.com.tw/icon_videoplayer.svg">';snippet+='<img src="https://graph.facebook.com/'+matches[2]+'/picture"></a>'}else{snippet='<a target="_blank" onclick="Mobile.Mailbox.refurl(this);" href="'+url+'">'+url+"</a>"}return snippet});return str};mobileMailbox.refurl=function(anchor){if(!anchor.href.match(/^https?:\/\/ref\.gamer\.com\.tw/)){anchor.href="https://ref.gamer.com.tw/redir.php?url="+encodeURIComponent(anchor.href)}};mobileMailbox.delMail=function(){var frm=document.getElementById("frmMail");if(frm.sn.value==""){alert("發生錯誤!");return}if(confirm("確定要刪除郵件？")){frm.submit()}};mobileMailbox.giveup=function(){if(confirm("確定要捨棄?")){window.history.back()}};mobileMailbox.checkMailData=function(){if(!mobileMailbox.sending){var frm=document.getElementById("frmMail");if(""==frm.to.value){alert("請填寫收件者")}else if(""==frm.sbj.value){alert("請填寫標題")}else if(""==frm.content_input.value){alert("請填寫內文")}else if(frm.sbj.value.utf8Length()>150){alert("標題太長啦~")}else if(frm.content_input.value.utf8Length()>32e3){alert("內文太長啦")}else if(frm.to.value.split(",").length>20){alert("收件者最多只能寄給 20 個帳號喔")}else{if(mobileMailbox.sending=confirm("確定要寄出嗎?")){jQuery.getJSON("/ajax/mailbox_token.php",{},function(result){var token=result.message;if(!token){alert("未知錯誤，請重試!");frm.to.focus();mobileMailbox.sending=false;return}jQuery.post("/ajax/mailbox_checkId.php",{to:frm.to.value},function(result){if(result.code!=0){alert(result.message);frm.to.focus();mobileMailbox.sending=false;return}frm.content.value=frm.content_input.value+"\n\n"+frm.content.value;jQuery("<input>").attr("type","hidden").attr("name","csrfToken").attr("value",token).appendTo(frm);frm.submit()},"json")})}}}};Mobile.Mailbox=mobileMailbox})(Mobile,jQuery);(function(Mobile){"use strict";var AntiAD=function(options){this._options={resetOnEnd:false,loopCheckTime:50,loopMaxNumber:2,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;"};this._var={bait:null,checking:false,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}};if(options!==undefined){this.setOption(options)}var self=this;var eventCallback=function(){setTimeout(function(){if(self._var.bait===null){self._creatBait()}setTimeout(function(){self._check()},1)},1)};if(window.addEventListener!==undefined){window.addEventListener("load",eventCallback,false)}else{window.attachEvent("onload",eventCallback)}};AntiAD.prototype._options=null;AntiAD.prototype._var=null;AntiAD.prototype._bait=null;AntiAD.prototype.setOption=function(options){for(var option in options){this._options[option]=options[option]}return this};AntiAD.prototype._creatBait=function(){var bait=document.createElement("div");bait.setAttribute("class",this._options.baitClass);bait.setAttribute("style",this._options.baitStyle);this._var.bait=window.document.body.appendChild(bait);this._var.bait.offsetParent;this._var.bait.offsetHeight;this._var.bait.offsetLeft;this._var.bait.offsetTop;this._var.bait.offsetWidth;this._var.bait.clientHeight;this._var.bait.clientWidth};AntiAD.prototype._destroyBait=function(){window.document.body.removeChild(this._var.bait);this._var.bait=null};AntiAD.prototype._check=function(loop){if(loop===undefined){loop=true}if(this._var.checking===true){return false}this._var.checking=true;if(this._var.bait===null){this._creatBait()}var self=this;this._var.loopNumber=0;if(loop===true){this._var.loop=setInterval(function(){self._checkBait(loop)},this._options.loopCheckTime)}setTimeout(function(){self._checkBait(loop)},1);return true};AntiAD.prototype._checkBait=function(loop){var detected=false;if(this._var.bait===null){this._creatBait()}if(window.document.body.getAttribute("abp")!==null||this._var.bait.offsetParent===null||this._var.bait.offsetHeight==0||this._var.bait.offsetLeft==0||this._var.bait.offsetTop==0||this._var.bait.offsetWidth==0||this._var.bait.clientHeight==0||this._var.bait.clientWidth==0){detected=true}if(window.getComputedStyle!==undefined){var baitTemp=window.getComputedStyle(this._var.bait,null);if(baitTemp&&(baitTemp.getPropertyValue("display")=="none"||baitTemp.getPropertyValue("visibility")=="hidden")){detected=true}}if(loop===true){this._var.loopNumber++;if(this._var.loopNumber>=this._options.loopMaxNumber){this._stopLoop()}}if(detected===true){this._stopLoop();this._destroyBait();this.emitEvent(true);if(loop===true){this._var.checking=false}}else if(this._var.loop===null||loop===false){this._destroyBait();this.emitEvent(false);if(loop===true){this._var.checking=false}}};AntiAD.prototype._stopLoop=function(detected){clearInterval(this._var.loop);this._var.loop=null;this._var.loopNumber=0};AntiAD.prototype.emitEvent=function(detected){var fns=this._var.event[detected===true?"detected":""];for(var i in fns){if(fns.hasOwnProperty(i)){fns[i]()}}if(this._options.resetOnEnd===true){this.clearEvent()}return this};AntiAD.prototype.clearEvent=function(){this._var.event.detected=[];this._var.event.notDetected=[]};AntiAD.prototype.on=function(detected,fn){this._var.event[detected===true?"detected":"notDetected"].push(fn);return this};AntiAD.prototype.onDetected=function(fn){return this.on(true,fn)};AntiAD.prototype.onNotDetected=function(fn){return this.on(false,fn)};Mobile.AntiAdB=AntiAD;if(Mobile.antiadb===undefined){Mobile.antiadb=new AntiAD({resetOnEnd:true})}})(Mobile);(function(Mobile,$){"use strict";var Gallery=function(){this.options={captionEl:false,fullscreenEl:false,shareEl:true,bgOpacity:.85,shareButtons:[{id:"download",label:"儲存圖片",url:"{{raw_image_url}}",download:true}]}};Gallery.prototype.init=function(selector){var images=$(selector).get();var items=[];var options=this.options;options.getThumbBoundsFn=function(index){var pageYScroll=window.pageYOffset||document.documentElement.scrollTop;var rect=images[index].getBoundingClientRect();return{x:rect.left,y:rect.top+pageYScroll,w:rect.width}};for(var i=0;i<images.length;i++){var src=images[i].getAttribute("data-src");if(!src||src.match(/https?:\/\/.+?\.bahamut\.com\.tw\/editor\/emotion\/[0-9]+\.gif/)){continue}src=src.replace(/(^https?:\/\/.+?\.bahamut\.com\.tw\/)[MS](\/2KU\/[0-9]{2}\/[a-zA-Z0-9]{10,}\.JPG$)/,"$1B$2");items.push({src:src,w:0,h:0})}$(selector).click(function(event){var index=0;var targetSrc=(event.target||event.srcElement).src;targetSrc=targetSrc.replace(/(^https?:\/\/.+?\.bahamut\.com\.tw\/)[MS](\/2KU\/[0-9]{2}\/[a-zA-Z0-9]{10,}\.JPG$)/,"$1B$2");for(var i=0;i<items.length;i++){if(targetSrc==items[i].src){index=i;break}}options.index=index;var gallery=new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,items,options);gallery.listen("gettingData",function(index,item){if(item.onLoading===undefined&&(item.w<1||item.h<1)){item.onLoading=true;var img=new Image;img.onload=function(){item.w=this.width;item.h=this.height;gallery.invalidateCurrItems();gallery.updateSize(true)};img.src=item.src}});gallery.init()})};Mobile.PhotoSwipe=new Gallery})(Mobile,egg);window.onresize=function(){egg.lightbox.refresh()};(function(window,document,undefined){function BAHA_mobilelist(element,opts){return this instanceof BAHA_mobilelist?this.init(element,opts):new BAHA_mobilelist(element,opts)}function nextYoN(){var nowscroll=window.scrollY;var totalscroll=document.body.offsetHeight;if(totalscroll-nowscroll<document.documentElement.clientHeight*2){return true}else{return false}}function MB_getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}function scrollevent(){}function HOMEscrollevent(){if(nextYoN()){ml.homelist(ml.nextpage)}}function GUILDscrollevent(){if(nextYoN()){ml.guildlist(ml.nextpage)}}function showloading(obj){if(true==obj.loading){return true}else{obj.loading=true;obj.loadtime=setTimeout(function(){egg.lightbox('<img width="250px" src="https://i2.bahamut.com.tw/loadingBar.gif">')},1e3);return false}}function hideloading(obj){obj.loading=false;clearTimeout(obj.loadtime);egg.lightbox.close()}function getNumberLayout(data){var html="";if("live"==data["service"]){html+='<span><i class="fa fa-eye"></i>'+data["viewer"]+"</span>"}else{html+='<span><i class="fa fa-thumbs-o-up"></i>'+data["gp"]+"</span>";html+='<span><i class="fa fa-comments"></i>'+data["comment"]+"</span>"}return html}function getClickUrl(data,url,ref){if("gnn"==data["service"]){url="https://m.gamer.com.tw/gnn/detail.php?sn="+data["sn"]}if("home"==data["service"]){url="https://m.gamer.com.tw/home/creationDetail.php?sn="+data["sn"]}if("forum"==data["service"]){url="https://m.gamer.com.tw/forum/C.php?bsn="+data["bsn"]+"&snA="+data["snA"]}if("live"==data["service"]){url=data["userid"]?"https://m.gamer.com.tw/home/live.php?u="+data["userid"]:"https://m.gamer.com.tw/home/liveIndex.php?type=2&acg_sn="+data["acg_sn"]+"&title="+encodeURIComponent(data["title"])}return ref+url}function showlayout(obj,data,clear,before,imglazy,ref){var before=before||"";var content='<div class="wrapper" style="margin-top:0px;">'+before;var article1="";var article2="";var dpr=Math.min(Math.round(window.devicePixelRatio),2);var AD_URL="https://ani.gamer.com.tw/?utm_source=anime_promo&utm_medium=mobile_web&utm_campaign=newyear2016";if(clear){var ad={sn:-1,title:"禁書目錄！刀劍神域！俺妹！人氣輕小說動畫大集結！",category:"廣告",ctime:"廣告",pic:"https://p2.bahamut.com.tw/PRJ/anime/anime_promo1_b.jpg?v1",thumbnail:"https://p2.bahamut.com.tw/PRJ/anime/anime_promo1_s.jpg?v1",service:"ad",kind:0,topNews:false,summary:"",gp:0,comment:0}}if("A"==obj.indexType){content+='<article class="index-service">';for(var key in data){var url="";var isAd=data[key]["service"]=="ad";var styleText=isAd?' style="background-color: #e2f5cd;"':"";if(isAd){url=AD_URL;data[key]["gp"]="爆";data[key]["comment"]="爆"}if("gnn"==data[key]["service"]){data[key]["category"]="GNN新聞 "+data[key]["category"]}if(data[key]["service"]=="home"&&data[key]["pic"].match(/bahamut\.com\.tw/)){if(dpr!=2){data[key]["pic"]=data[key]["pic"]+"?w=640"}}article1+='<section class="index-boxA"'+styleText+">";article1+='<a href="'+getClickUrl(data[key],url,ref)+'">';if(data[key]["topNews"]==true){article1+='<i class="topnews2">頭條</i><h1>'+data[key]["title"]+"</h1>"}else{article1+="<h1>"+data[key]["title"]+"</h1>"}article1+="<p>";if(""!=data[key]["pic"]){article1+='<img class="lazyload" data-src="'+data[key]["pic"]+'"><img class="lazyload" data-src="'+data[key]["pic"]+'">'}article1+="</p>";article1+='<div class="boxA-foo">';article1+=getNumberLayout(data[key]);article1+='<p class="index-boxA-type">';article1+="<span>"+data[key]["category"]+"</span>";if("forum"==data[key]["service"]){article1+="<span>"+data[key]["boardName"]+"</span>"}article1+="</p>";article1+="</div>";article1+="</a>";article1+="</section> "}content+=article1;content+="</article>"}if("B"==obj.indexType){var i=0;for(var key in data){i++;var url="";var isAd=data[key]["service"]=="ad";var styleText=isAd?' style="background-color: #e2f5cd;"':"";if(isAd){url=AD_URL;data[key]["gp"]="爆";data[key]["comment"]="爆"}if("gnn"==data[key]["service"]){data[key]["category"]="GNN新聞 "+data[key]["category"]}if(data[key]["service"]=="home"&&data[key]["pic"].match(/bahamut\.com\.tw/)){if(dpr!=2){data[key]["pic"]=data[key]["pic"]+"?w=640"}}if(i%2!=0){article1+='<section class="index-boxB"'+styleText+">";article1+='<a href="'+getClickUrl(data[key],url,ref)+'">';article1+="<p>";if(""!=data[key]["pic"]){article1+='<img class="lazyload" data-src="'+data[key]["pic"]+'"><img class="lazyload" data-src="'+data[key]["pic"]+'">'}article1+="</p>";if(data[key]["topNews"]==true){article1+='<i class="topnews2">頭條</i><h1>'+data[key]["title"]+"</h1>"}else{article1+="<h1>"+data[key]["title"]+"</h1>"}article1+="<span>"+data[key]["category"]+"</span>";if("forum"==data[key]["service"]){article1+="<span>"+data[key]["boardName"]+"</span>"}article1+='<div class="boxA-foo">';article1+=getNumberLayout(data[key]);article1+="</div>";article1+="</a>";article1+="</section> "}else{article2+='<section class="index-boxB"'+styleText+">";article2+='<a href="'+getClickUrl(data[key],url,ref)+'">';article2+="<p>";if(""!=data[key]["pic"]){article2+='<img class="lazyload" data-src="'+data[key]["pic"]+'"><img class="lazyload" data-src="'+data[key]["pic"]+'">'}article2+="</p>";if(data[key]["topNews"]==true){article2+='<i class="topnews2">頭條</i><h1>'+data[key]["title"]+"</h1>"}else{article2+="<h1>"+data[key]["title"]+"</h1>"}article2+="<span>"+data[key]["category"]+"</span>";if("forum"==data[key]["service"]){article2+="<span>"+data[key]["boardName"]+"</span>"}article2+='<div class="boxA-foo">';article2+=getNumberLayout(data[key]);article2+="</div>";article2+="</a>";article2+="</section> "}}content+='<article class="index-service idnex-typeB">'+article1+'</article><article class="index-service idnex-typeB">'+article2+"</article>"}if("C"==obj.indexType){content+='<article class="index-service">';for(var key in data){var url="";var isAd=data[key]["service"]=="ad";var styleText=isAd?' style="background-color: #e2f5cd;"':"";if(isAd){url=AD_URL;data[key]["gp"]="爆";data[key]["comment"]="爆"}var pic="";if("gnn"==data[key]["service"]){data[key]["category"]="GNN新聞 "+data[key]["category"]}if(data[key]["service"]=="live"){pic=data[key]["pic"];article1+=data[key]["userid"]?'<section class="live-hall">':'<section class="index-boxC">'}else{article1+='<section class="index-boxC">';if(data[key]["pic"].match(/bahamut\.com\.tw/)){pic=data[key]["pic"].replace("bahamut.com.tw/B/","bahamut.com.tw/S/");pic=pic.replace("_B","");if(dpr!=2){pic=pic+"?w=180"}}}article1+='<a href="'+getClickUrl(data[key],url,ref)+'"'+styleText+">";if(""!=pic&&"forum"!=data[key]["service"]){article1+='<span><img class="lazyload" data-src="'+pic+'"></span>'}else{article1+='<span><img src="https://i2.bahamut.com.tw/mobile_2k14/noimg90.png"></span>'}article1+="<h1>";if(data[key]["topNews"]==true){article1+='<span class="topnews2">頭條</span>'}article1+=data[key]["title"]+"</h1>";article1+="<p>"+data[key]["category"]+"</p>";if("forum"==data[key]["service"]){article1+="<p>"+data[key]["boardName"]+"</p>"}article1+="</a></section>"}content+=article1;content+="</article>"}content+='</div><div id="endloading" style="text-align:center;"><img width="250px" src="https://i2.bahamut.com.tw/loadingBar.gif"></div>';if(true==clear||""==egg(".item:eq("+view.flipsnap.currentPoint+")").html()){egg(".item:eq("+view.flipsnap.currentPoint+")").html(content)}else{if(""!=article1){var article=document.createElement("div");article.innerHTML=article1;egg(article).appendTo(egg("article").get(0))}if(""!=article2){var article=document.createElement("div");article.innerHTML=article2;egg(article).appendTo(egg("article").get(1))}}}function dfp_ad(service,elem,code,size){if(window.Cookies){bahalv=Cookies.get("BAHALV")||""}else if(window.getCookie){bahalv=getCookie("BAHALV")}else if(window.jQuery&&jQuery.cookie){bahalv=jQuery.cookie("BAHALV")}else{bahalv=""}bahalv=bahalv?bahalv:0;var gptid="div-gpt-ad-"+Date.now();googletag.cmd.push(function(){var slot=googletag.defineSlot("/1017768/"+code,size,gptid).addService(googletag.pubads()).setTargeting("service",service);window.DFP.setTargeting();if(bahalv){slot.setTargeting("LV",bahalv)}googletag.enableServices()});var content='<div id="'+gptid+'" class="index-boxC"></div>';jQuery(content).insertAfter(elem);googletag.cmd.push(function(){googletag.display(gptid)})}function insertHotMobileGameBoard(obj,data){if("A"==obj.indexType){var elem=jQuery(".index-boxA")[3]}else if("C"==obj.indexType){var elem=jQuery(".index-boxC")[3]}var content='</div><section class="index-hotmobile">';content+='<div class="title">熱門手遊</div>';for(var key in data){if(key>5){break}var no=Number(key)+1;content+='<a href="https://m.gamer.com.tw/acg/acgDetail.php?s='+data[key]["sn"]+'"><span><img src="'+data[key]["pic"]+'"></span>';content+="<h1><b>"+no+"</b>"+data[key]["title"]+"</h1></a>"}content+='<a href="https://m.gamer.com.tw/?t=HOTGAME" class="more">看更多</a></section>';jQuery(content).insertBefore(elem)}function backhistorycontent(obj,me){var who=bahadata().get("beforewho")||"";var content=bahadata().get("beforecontent")||"";var historyYoN=false;if(me==who&&""!=content){egg(".item:eq("+view.flipsnap.currentPoint+")").html(content);switch(me){case"GNN":window.onscroll=GNNscrollevent;var aobj=egg(".wrapper").find("a").get();break;case"HOME":window.onscroll=HOMEscrollevent;var aobj=egg(".wrapper").find("a").get();break;case"GUILD":window.onscroll=GUILDscrollevent;var aobj=egg(".wrapper").find("a:[href^=http]").get();break;case"FORUM":window.onscroll=FORUMscrollevent;var aobj=egg(".wrapper").find("a").get();break}obj.nextpage=parseInt(bahadata().get("beforenextpage"),10);egg.event.add(aobj,"click",function(){bahadata().set("beforecontent",egg(".item:eq("+view.flipsnap.currentPoint+")").html());bahadata().set("beforenextpage",obj.nextpage);bahadata().set("beforewho",me)});historyYoN=true}bahadata().del("beforecontent");bahadata().del("beforenextpage");bahadata().del("beforewho");return historyYoN}BAHA_mobilelist.prototype.init=function(element,opts){var self=this;self.nextpage=1;self.loading=false;self.loadtime;self.indexkind=bahadata().get("MCK_indexKinds")||{gnn_1:1,gnn_3:1,gnn_4:1,gnn_5:1,gnn_8:1,gnn_9:1,gnn_10:1,gnn_11:1,gnn_13:1,home_1:1,home_2:1,home_3:1,home_4:1,home_5:1,home_6:1,home_7:1,forum_1:1,forum_2:1,forum_3:1};self.indexType=bahadata().get("MCK_indexType")||"C";if("object"!=typeof self.indexkind){self.indexkind=JSON.parse(self.indexkind)}};BAHA_mobilelist.prototype.indexlist=function(){var self=this;backhistorycontent(self,"INDEX");if(showloading(self)){return}var params="";for(var key in self.indexkind){if(1==self.indexkind[key]){var tmp=key.split("_");params+="kind["+tmp[0]+"][]="+tmp[1]+"&"}}egg.ajax({url:"/ajax/MB_index_list.php",param:params,method:"GET",success:function(rjson){var rdata=JSON.parse(rjson);showlayout(self,rdata,true,"",false,"https://ref.gamer.com.tw/0100053/*");egg("#endloading").hide();var elem=jQuery(".index-boxC")[2];dfp_ad("mychoice",elem,"AD_mobileweb_mix_list",["fluid"]);hideloading(self)}})};BAHA_mobilelist.prototype.homelist=function(page){var self=this;if(1==page){if(backhistorycontent(self,"HOME")){return}}if(showloading(self)){return}var mapping=Array();var mapping=[{kind:0,name:"熱門創作"},{kind:-1,name:"全部創作"},{kind:1,name:"日誌達人"},{kind:2,name:"小說達人"},{kind:3,name:"插畫達人"},{kind:9,name:"漫畫達人"},{kind:4,name:"精選閣樓"},{kind:5,name:"Cosplay"},{kind:6,name:"巴卦快報"}];var k=parseInt($.urlParam("k1"));var kindstxt="<div class=\"hala_drop\"><select id=\"homekind\" onchange=\"kind = this.value;window.history.pushState('homeIndex.php', '巴哈姆特手機版', 'homeIndex.php');ml.homelist(1);\">";for(i=0;i<mapping.length;i++){kindstxt+='<option value="'+mapping[i]["kind"]+'">'+mapping[i]["name"]+"</option>"}kindstxt+="</select></div>";var clear=page<=1;self.nextpage=page+1;var kind=k||(egg("#homekind").val()||0);jQuery.ajax({url:"https://api.gamer.com.tw/mobile_app/bahamut/v2/home_creation_list.php",data:{kind:kind,p:page},method:"GET",xhrFields:{withCredentials:true},dataType:"json"}).done(function(data){console.log(data);if(typeof data.error!="undefined"){return}if(data.data.list.length==0){window.onscroll=scrollevent;jQuery("#endloading").hide()}else{window.onscroll=HOMEscrollevent}showlayout(self,data.data.list,clear,kindstxt,false,"https://ref.gamer.com.tw/0100058/*");jQuery("#homekind option[value="+kind+"]").attr("selected","selected");jQuery(".wrapper").find("a").click(function(){bahadata().set("beforecontent",jQuery(".item:eq("+view.flipsnap.currentPoint+")").html());bahadata().set("beforenextpage",self.nextpage);bahadata().set("beforewho","HOME")});var elem=jQuery(".index-boxC")[2];dfp_ad("home",elem,"AD_mobileweb_creation_list",["fluid"]);hideloading(self)})};BAHA_mobilelist.prototype.myboardlist=function(){var self=this;backhistorycontent(self,"MYBOARD");if(showloading(self)){return}egg.ajax({url:"/ajax/MB_myboard.php",method:"GET",success:function(rjson){window.onscroll=scrollevent;var lastBoard=window.Forum.LastBoard.getData(),$container=$("#forum-lastBoard"),MAX_SHOW=3;var content='<form method="GET" action="forum/searchb.php"><p><input class="myfavinput" type="text" placeholder="找看板" name="kw"></p></form><div class="wrapper" style="margin-top:0px"><h2><i class="fa fa-caret-right"></i>最近閱覽</h2>';content+='<ul class="my_bo">';if(lastBoard){for(var i=0;i<MAX_SHOW&&lastBoard[i];i++){var row=lastBoard[i];row[1]=row[1].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");content+='<li><a href="https://ref.gamer.com.tw/0100043/*https://m.gamer.com.tw/forum/B.php?bsn='+row[0]+'">'+row[1]+"</a></li>"}}content+="</ul>";rdata=JSON.parse(rjson);if(undefined===rdata.code){content+='<h2><i class="fa fa-caret-right"></i>我的看板</h2>';content+='<ul class="my_bo">';for(var key in rdata){content+='<li><a href="https://ref.gamer.com.tw/0100043/*https://m.gamer.com.tw/forum/B.php?bsn='+rdata[key]["bsn"]+'">'+rdata[key]["title"]+"</a></li>"}content+="</ul>"}content+="<div>";egg(".item:eq("+view.flipsnap.currentPoint+")").html(content);hideloading(self)}})};BAHA_mobilelist.prototype.guildlist=function(page){var self=this;if(1==page){if(backhistorycontent(self,"GUILD")){return}}if(showloading(self)){return}var mapping=Array();mapping[0]={kind:0,name:"綜合"};mapping[1]={kind:2,name:"遊戲"};mapping[2]={kind:12,name:"手機"};mapping[3]={kind:1,name:"線上"};mapping[4]={kind:13,name:"TV 掌機"};mapping[5]={kind:3,name:"動漫輕小說"};mapping[6]={kind:14,name:"惡搞 KUSO"};mapping[7]={kind:5,name:"創作"};mapping[8]={kind:9,name:"生活"};mapping[9]={kind:6,name:"偶像影音"};mapping[10]={kind:7,name:"模型"};mapping[11]={kind:11,name:"獨立開發者"};mapping[12]={kind:10,name:"其他"};var k=parseInt($.urlParam("t"));var kindstxt="<div class=\"hala_drop\"><select id=\"guildtype\" onchange=\"type=this.value;window.history.pushState('guildIndex.php', '巴哈姆特手機版', 'guildIndex.php');ml.guildlist(1);\">";for(i=0;i<mapping.length;i++){kindstxt+='<option value="'+mapping[i]["kind"]+'">'+mapping[i]["name"]+"</option>"}kindstxt+="</select></div>";if(1>=page){var clear=true}else{var clear=false}self.nextpage=page+1;var type=k||(egg("#guildtype").val()||0);var targetdiv=0;if(view.flipsnap){targetdiv=view.flipsnap.currentPoint}egg.ajax({url:"/ajax/MB_guild_list.php",param:"t="+type+"&p="+page,method:"GET",success:function(rjson){if("[]"==rjson){window.onscroll=scrollevent}else{window.onscroll=GUILDscrollevent}var rdata=JSON.parse(rjson);var guildlist="";for(var key in rdata){guildlist+=`\n          <section class="index-boxC">\n            <a href="https://guild.gamer.com.tw/guild.php?gsn=${rdata[key]["sn"]}">\n              <span><img class="lazyload" data-src="${rdata[key]["pic"]}"></span>\n              <h1>${rdata[key]["title"]}</h1>\n              <p>${rdata[key]["joinType"]}</p>\n            </a>\n          </section>`}var content='<div class="wrapper" style="margin-top:0px;"><article class="index-service">';content+=kindstxt;content+=guildlist;content+='</article></div><div id="endloading" style="text-align:center;"><img width="250px" src="https://i2.bahamut.com.tw/loadingBar.gif"></div>';if(1==page){egg(".item:eq("+targetdiv+")").html(content)}else{var div=document.createElement("article");div.className="index-service";div.innerHTML=guildlist;egg(div).appendTo(egg(".wrapper").get(0))}if(rjson=="[]"){egg("#endloading").hide()}$("#guildtype option[value="+type+"]").attr("selected","selected");egg.event.add(egg(".wrapper").find("a:[href^=http]").get(),"click",function(){bahadata().set("beforecontent",egg(".item:eq("+targetdiv+")").html());bahadata().set("beforenextpage",self.nextpage);bahadata().set("beforewho","GUILD")});var elem=jQuery(".index-boxC")[2];dfp_ad("guild",elem,"AD_mobileweb_guild_list",["fluid"]);hideloading(self)}})};BAHA_mobilelist.prototype.livelist=function(type,acg_sn){var self=this;backhistorycontent(self,"LIVE");if(showloading(self)){return}var mapping=Array();var param=type==2?"game":"";var selected="";mapping[0]={param:"",name:"綜合"};mapping[1]={param:"hotgame",name:"熱門遊戲"};if(type!=2){var kindstxt='<div class="hala_drop"><select id="livetype" onchange="changeType()");">';for(i=0;i<mapping.length;i++){if(type==i){param=mapping[i]["param"];selected="selected"}else{selected=""}kindstxt+='<option value="'+mapping[i]["param"]+'" '+selected+">"+mapping[i]["name"]+"</option>"}kindstxt+="</select></div>"}egg.ajax({url:"/ajax/MB_home_live_list.php",param:"type="+param+"&acg_sn="+acg_sn,method:"GET",success:function(rjson){if("[]"==rjson){window.onscroll=scrollevent}var rdata=JSON.parse(rjson);showlayout(self,rdata,true,kindstxt,false,"https://ref.gamer.com.tw/0100058/*");if(param=="hotgame"){var elem=jQuery(".index-boxC")[2]}else{var elem=jQuery(".live-hall")[2]}dfp_ad("home",elem,"AD_mobileweb_live_list",[[320,100],[300,100]]);$("#livetype option[value="+type+"]").attr("selected","selected");egg(".item:eq("+view.flipsnap.currentPoint+")").html();hideloading(self);egg("#endloading").hide()}})};BAHA_mobilelist.prototype.showMsg=function(msg,config){var config=config||{};var buttontxt="";if(config.left){buttontxt+='<a href="javascript:;" onClick="'+config.onLeft+'">'+config.left+"</a>"}if(config.right){buttontxt+='<a href="javascript:;" onClick="'+config.onRight+'">'+config.right+"</a>"}var lconfig={css:{width:"70%"}};egg.lightbox('<div class="light-box"><p>'+msg+"</p><span>"+buttontxt+"</span></div>",lconfig)};BAHA_mobilelist.prototype.showguildjoin=function(sn){egg.lightbox.close();var content="";content+='<div class="bala_post">';content+='<i class="fa fa-times-circle" onclick="egg.lightbox.close()"></i>';content+='<p class="bala_post_msg">請填寫自我介紹：(限50字)<br><textarea id="guildreason" style="height:130px"></textarea><button onclick="ml.guildjoin('+sn+');">送出</button></p>';content+="</div>";var config={css:{width:"100%","text-align":"left","z-index":"101",top:"120"}};egg.lightbox(content,config);egg.lightbox.refresh();egg("#egg_mask").css("z-index",100)};BAHA_mobilelist.prototype.guildjoin=function(sn){var self=this;var txt=egg("#guildreason").val()||"";egg.lightbox.close();MB_getCSRFToken().done(function(token){var param={s:sn,t:txt,token:token};jQuery.ajax({url:"/ajax/MB_guildjoin.php",data:param,method:"POST",dataType:"json"}).done(function(rdata){if(rdata.errMsg){alert(rdata.errMsg);return false}if(rdata.okMsg){alert(rdata.okMsg);if("gotoguild"==rdata.action){bahadata().set("beforecontent",egg(".item:eq("+view.flipsnap.currentPoint+")").html());bahadata().set("beforenextpage",self.nextpage);bahadata().set("beforewho","GUILD");location.href="https://ref.gamer.com.tw/0100057/*https://m.gamer.com.tw/guild/guild.php?sn="+sn}}})})};BAHA_mobilelist.prototype.dfp_ad=function(service,elem,code,size){dfp_ad(service,elem,code,size)};if(typeof exports=="object"){module.exports=BAHA_mobilelist}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_mobilelist})}else{window.BAHA_mobilelist=BAHA_mobilelist}})(window,window.document);(function(window,document,undefined){function BAHA_homefriendapply(opts){return this instanceof BAHA_homefriendapply?this.init(opts):new BAHA_homefriendapply(opts)}BAHA_homefriendapply.prototype.init=function(opts){var self=this;opts=opts||{};self.div=opts.div||""};BAHA_homefriendapply.prototype.list=function(){var self=this;egg.ajax({url:"/ajax/MB_homeFriendApplyList.php",method:"GET",success:function(rjson){var applylist=JSON.parse(rjson);if(1==applylist.error){alert(applylist.msg);return}var content="";for(var key in applylist){content+='<div class="home_friend" id="F_'+applylist[key].userid+'">';content+="<img src="+applylist[key].avatar+">";content+="<div>";content+='<a href="https://m.gamer.com.tw/home/home.php?owner='+applylist[key].userid+'">'+applylist[key].userid+"</a><b>("+applylist[key].nick+")</b><span>"+applylist[key].applymsg+"</span>";content+='<p><a href="javascript:;" onclick="BAHA_homefriendapply().do(1,\''+applylist[key].userid+'\')">加好友</a><a href="javascript:;" onclick="BAHA_homefriendapply().do(3,\''+applylist[key].userid+'\')">加訂戶</a><a href="javascript:;" onclick="BAHA_homefriendapply().do(2,\''+applylist[key].userid+"')\">忽略</a></p>";content+="</div>";content+="</div>"}if(!content){content='<div style="height:240px;position:relative;"><div style="width:100%;position:absolute;top:50%;text-align:center;">目前沒有人提出好友邀請</div></div>'}egg(self.div).html(content)}})};BAHA_homefriendapply.prototype.do=function(action,userid){switch(action){case 1:var msg="加好友完成";break;case 2:var msg="忽略完成";break;case 3:var msg="加訂戶完成";break;default:alert("參數錯誤");return}MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_homeFriendApplya.php",method:"POST",data:{a:action,u:userid,token:token},dataType:"json"}).done(function(rdata){if(1==rdata.error){alert(rdata.msg);return}if(1==rdata.ok){egg("#F_"+userid).hide();alert(msg);return}alert("系統忙碌請稍候再試")})})};function getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}if(typeof exports=="object"){module.exports=BAHA_homefriendapply}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_homefriendapply})}else{window.BAHA_homefriendapply=BAHA_homefriendapply}})(window,window.document);(function(window,document,undefined){function BAHA_homefriendadd(opts){return this instanceof BAHA_homefriendadd?this.init(opts):new BAHA_homefriendadd(opts)}BAHA_homefriendadd.prototype.init=function(userid){var self=this;self.userid=userid||"";if(""==self.userid){alert("無此帳號");return}egg.ajax({url:"/ajax/MB_homeFriendGetCategory.php",method:"GET",async:"SYNC",success:function(rjson){if(""==rjson||"ERROR"==rjson){alert("系統忙碌請稍候再試");return}if("NOLOGIN"==rjson){alert("請先登入");location.href="https://user.gamer.com.tw/login.php";return}self.category=JSON.parse(rjson)}});if(self.category){self.content='<div class="slbox home">';self.content+='<i class="fa fa-times-circle" onclick="egg.lightbox.close()"></i>';self.content+='<p>分類<select id="faddcategory">';for(var key in self.category){self.content+='<option value="'+key+'"'+(1==key?"selected":"")+">"+self.category[key]+"</option>"}self.content+="</select></p>";self.content+='<p>自介<textarea id="faddreason"></textarea><span>限50字，非必填</span></p>';self.content+='<footer><button id="faddbutton">確定</button></footer>';self.content+="</div>"}return self};BAHA_homefriendadd.prototype.box=function(){var self=this;if(self.content){egg.lightbox(self.content,{css:{"text-align":"",width:"80%"}});egg.event.add(egg("#faddbutton").get(),"click",function(){self.do(self)})}};BAHA_homefriendadd.prototype.do=function(self){var fc=egg("#faddcategory").val()||1;var fr=egg("#faddreason").val()||"";MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_homeFriendAdd.php",data:{f:self.userid,fc:fc,fr:fr,token:token},method:"POST",dataType:"json"}).done(function(rdata){alert(rdata.msg);if(1==rdata.ok){egg.lightbox.close()}})})};function getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}if(typeof exports=="object"){module.exports=BAHA_homefriendadd}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_homefriendadd})}else{window.BAHA_homefriendadd=BAHA_homefriendadd}})(window,window.document);(function(window,document,undefined){function BAHA_homecreationaccuse(opts){return this instanceof BAHA_homecreationaccuse?this.init(opts):new BAHA_homecreationaccuse(opts)}function getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}BAHA_homecreationaccuse.prototype.init=function(sn){var self=this;self.sn=sn||0};BAHA_homecreationaccuse.prototype.box=function(){var self=this;var content='<div class="slbox home"><i class="fa fa-times-circle" onclick="egg.lightbox.close()"></i><p>這篇是';content+='<select onchange="BAHA_homecreationaccuse.reasonChange(this);" id="areason"><option value="0">-請選擇理由-</option><option value="1">販售、提供盜版物</option><option value="2">公開徵求盜版物</option><option value="3">討論侵權私人伺服器</option><option value="4">商業廣告或活動</option><option value="5">從事涉及隱私的問卷活動</option><option value="6">發表限制級內容或連結</option><option value="7">未經授權轉載、盜用他人著作</option><option value="8">未經當事人同意公開他人之個人資料、信件或訊息</option><option value="9">在站內公開性之版面進行謾罵</option><option value="10">洗板(異常衝高某統計數值達三次以上)</option><option value="11">從事虛擬寶物現金交易</option><option value="12">利用付費功能進行詐騙</option><option value="13">使用非正常操作手段干擾系統</option><option value="14">蓄意使用系統漏洞</option><option value="15">蓄意張貼含有病毒、木馬程式連結</option><option value="16">發表者非Coser本人。</option><option value="17">發表內容與Cosplay 無關。</option><option value="18">發表內容為自創角色。</option><option value="19">其他理由</option></select>';content+='<div style="display:none;" id="homeCreationAccuseReasonContainer"><input style="padding:5px;margin:5px;width:90%;" type="text" id="homeCreationAccuseReason" placeholder="請輸入檢舉理由"></div>';content+='<span style="padding:10px 0 0 0;">人身攻擊、侵犯個人隱私、著作權限當事人檢舉。惡意檢舉，經查證屬實將依站規處分。</span></p><footer><button onclick="BAHA_homecreationaccuse('+self.sn+').accuse()">確定</button></footer></div>';egg.lightbox(content,{css:{"text-align":"",width:"80%"}})};BAHA_homecreationaccuse.reasonChange=function(elem){if(elem.selectedIndex==19){egg("#homeCreationAccuseReasonContainer").show()}else{egg("#homeCreationAccuseReasonContainer").hide()}};BAHA_homecreationaccuse.prototype.accuse=function(sn){var reasonIndex=parseInt(egg("#areason").val(),10);if(0==reason){alert("請選擇檢舉理由");return}var reason="";if(reasonIndex==19){reason=egg("#homeCreationAccuseReason").val();if(reason==""){alert("請輸入檢舉理由");return}}var self=this;MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_homeCreationAccusea.php",data:{csn:self.sn,aExp:reasonIndex,token:token,reason:reason},method:"POST",dataType:"json"}).done(function(rdata){alert(rdata.msg);egg.lightbox.close()})})};if(typeof exports=="object"){module.exports=BAHA_homecreationaccuse}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_homecreationaccuse})}else{window.BAHA_homecreationaccuse=BAHA_homecreationaccuse}})(window,window.document);(function(window,document,undefined){function BAHA_guildMemberList(opts){return this instanceof BAHA_guildMemberList?this.init(opts):new BAHA_guildMemberList(opts)}function getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}function nextYoN(){var nowscroll=window.scrollY;var totalscroll=document.body.offsetHeight;if(totalscroll-nowscroll<document.documentElement.clientHeight*2){return true}else{return false}}function scrollevent(){}function MEMBERscrollevent(){if(nextYoN()){gl.member(gl.nextpage)}}function showloading(obj){if(true==obj.loading){return true}else{obj.loading=true;obj.loadtime=setTimeout(function(){egg.lightbox('<img width="250px" src="https://i2.bahamut.com.tw/loadingBar.gif">')},1e3);return false}}function hideloading(obj){obj.loading=false;clearTimeout(obj.loadtime);egg.lightbox.close()}BAHA_guildMemberList.prototype.init=function(sn){var self=this;self.gsn=sn;self.nextpage=2;self.loading=false;self.loadtime;self.suserid="";self.nowclickaction};BAHA_guildMemberList.prototype.search=function(userid){var self=this;self.suserid=userid;self.member(1)};BAHA_guildMemberList.prototype.member=function(page){var self=this;if(showloading(self)){return}egg.ajax({url:"/ajax/MB_guildMemberList.php",param:"sn="+self.gsn+"&page="+page+"&u="+self.suserid,method:"GET",success:function(rjson){if("[]"==rjson){window.onscroll=scrollevent}else{window.onscroll=MEMBERscrollevent}var rdata=JSON.parse(rjson);if(1==rdata.error){hideloading(self);alert(rdata.msg);return}if(1==page){egg(".item:eq("+view.flipsnap.currentPoint+")").html('<p class="hala_search_bar"><input name="kw" type="text" placeholder="搜尋帳號" onKeyUp="if(13==event.keyCode){gl.search(this.value)};"></p><ul class="guild_member"></ul>')}self.nextpage=page+1;for(var key in rdata){var li=document.createElement("li");if("Y"==rdata[key].del){li.id="MEMBER_"+rdata[key].userid;li.innerHTML='<i class="fa fa-times-circle-o" onclick="gl.delmembercheck(\''+rdata[key].userid+'\')"></i><a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'"><img src="'+rdata[key].avatar+'"></a><a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'">'+rdata[key].userid+"</a><span>"+rdata[key].nick+"</span>"}else{li.innerHTML='<a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'"><img src="'+rdata[key].avatar+'"></a><a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'">'+rdata[key].userid+"</a><span>"+rdata[key].nick+"</span>"}egg(li).appendTo(egg(".guild_member").get(0))}hideloading(self)}})};BAHA_guildMemberList.prototype.delmembercheck=function(userid){var self=this;var buttontxt="";buttontxt+='<a href="javascript:;" onClick="gl.delmember(\''+userid+"')\">是</a>";buttontxt+='<a href="javascript:;" onClick="egg.lightbox.close();">否</a>';var lconfig={css:{width:"70%"}};egg.lightbox('<div class="light-box"><p>確定要刪除此成員？</p><span>'+buttontxt+"</span></div>",lconfig)};BAHA_guildMemberList.prototype.delmember=function(userid){var self=this;egg.lightbox.close();MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_guildMemberDel.php",method:"POST",data:{s:self.gsn,u:userid,token:token},dataType:"json"}).done(function(rdata){if(1==rdata.ok){egg("#MEMBER_"+userid).hide()}alert(rdata.msg)})})};BAHA_guildMemberList.prototype.apply=function(){var self=this;egg.ajax({url:"/ajax/MB_guildMemberListC.php",method:"GET",param:"sn="+self.gsn,success:function(rjson){if("[]"==rjson){alert("沒有待審核人員");return}var rdata=JSON.parse(rjson);if(1==rdata.error){alert(rdata.msg);exit()}egg(".item:eq("+view.flipsnap.currentPoint+")").html('<ul class="guild_member2"></ul>');for(var key in rdata){var li=document.createElement("li");li.id="MEMBER_"+rdata[key].userid;li.innerHTML='<i class="fa fa-user-plus" onclick="gl.applycheck(\''+rdata[key].userid+'\');"></i><a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'"><img src="'+rdata[key].avatar+'"></a><a href="https://m.gamer.com.tw/home/home.php?owner='+rdata[key].userid+'">'+rdata[key].userid+"</a><span>("+rdata[key].nick+")</span><p>"+rdata[key].info+"</p>";egg(li).appendTo(egg(".guild_member2").get(0))}}})};BAHA_guildMemberList.prototype.applycheck=function(userid){var buttontxt="";buttontxt+='<a href="javascript:;" onClick="gl.applydo(\''+userid+"','Y')\">通過</a>";buttontxt+='<a href="javascript:;" onClick="gl.applydo(\''+userid+"','N')\">不通過</a>";var lconfig={css:{width:"70%"}};egg.lightbox('<div class="light-box"><p>通過申請？</p><span>'+buttontxt+"</span></div>",lconfig)};BAHA_guildMemberList.prototype.applydo=function(userid,action){var self=this;egg.lightbox.close();MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_guildMemberC.php",method:"POST",data:{s:self.gsn,u:userid,a:action,token:token},dataType:"json"}).done(function(rdata){if(1==rdata.ok){egg("#MEMBER_"+userid).hide()}alert(rdata.msg)})})};if(typeof exports=="object"){module.exports=BAHA_guildMemberList}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_guildMemberList})}else{window.BAHA_guildMemberList=BAHA_guildMemberList}})(window,window.document);(function(window,document,undefined){function BAHA_forumPostAccuse(opts){return this instanceof BAHA_forumPostAccuse?this.init(opts):new BAHA_forumPostAccuse(opts)}function getCSRFToken(){return jQuery.ajax({url:"/ajax/MB_getCSRFToken.php",cache:false})}BAHA_forumPostAccuse.prototype.init=function(){};BAHA_forumPostAccuse.prototype.box=function(bsn,sn){var content='<div class="slbox home"><i class="fa fa-times-circle" onclick="egg.lightbox.close()"></i><p>這篇是';content+='<select onchange="BAHA_forumPostAccuse.reasonChange(this);" id="areason"><option value="">-請選擇理由-</option><option value="與本板主題無關">與本板主題無關</option><option value="洗板">洗板</option><option value="謾罵">謾罵</option><option value="盜版">盜版</option><option value="限制級">限制級</option><option value="其他理由">其他理由</option></select>';content+='<div style="display:none;" id="forumPostAccuseReasonContainer"><input style="padding:5px;margin:5px;width:90%;" type="text" id="forumPostAccuseReason" placeholder="請輸入檢舉理由"></div>';content+='<span style="padding:10px 0 0 0;">人身攻擊、侵犯個人隱私、著作權限當事人檢舉。惡意檢舉，經查證屬實將依站規處分。</span></p><footer><button onclick="BAHA_forumPostAccuse().accuse('+bsn+","+sn+')">確定</button></footer></div>';egg.lightbox(content,{css:{"text-align":"",width:"80%"}})};BAHA_forumPostAccuse.reasonChange=function(elem){if(elem.selectedIndex==6){egg("#forumPostAccuseReasonContainer").show()}else{egg("#forumPostAccuseReasonContainer").hide()}};BAHA_forumPostAccuse.prototype.accuse=function(bsn,sn){var reason="";if(document.getElementById("areason").selectedIndex==6){reason=egg("#forumPostAccuseReason").val();if(reason==""){alert("請輸入檢舉理由");return}}else{reason=egg("#areason").val();if(""==reason){alert("請選擇檢舉理由");return}}var self=this;MB_getCSRFToken().done(function(token){jQuery.ajax({url:"/ajax/MB_forumPostAccusea.php",data:{bsn:bsn,sn:sn,aExp:reason,token:token},method:"POST",dataType:"json"}).done(function(rdata){if(0==rdata.code){alert(rdata.message)}else{alert("檢舉完成")}egg.lightbox.close()})})};if(typeof exports=="object"){module.exports=BAHA_forumPostAccuse}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_forumPostAccuse})}else{window.BAHA_forumPostAccuse=BAHA_forumPostAccuse}})(window,window.document);(function(window,document,undefined){function BAHA_forumMarketAD(opts){return this instanceof BAHA_forumMarketAD?this.init(opts):new BAHA_forumMarketAD(opts)}BAHA_forumMarketAD.prototype.init=function(opts){var self=this;self.data=opts.ad||[]};BAHA_forumMarketAD.prototype.display=function(obj){var self=this;if(0==self.data.length){return}var rand=self.data[Math.floor(Math.random()*self.data.length)];var content='<ul class="hala_blist"><li class="hala_listad"><a href="'+rand.link+'" target="_blank"><p class="badlist fa fa-lightbulb-o"></p><h4>'+rand.text+'</h4><p class="baddate">遊戲官方提供<span>'+rand.stime.substr(0,10)+"</span></p></a></li></ul>";egg("#"+obj).html(content)};if(typeof exports=="object"){module.exports=BAHA_forumMarketAD}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_forumMarketAD})}else{window.BAHA_forumMarketAD=BAHA_forumMarketAD}})(window,window.document);(function(window,document,undefined){function BAHA_AD(data){return this instanceof BAHA_AD?this.init(data):new BAHA_AD(data)}function getnowNum(){var sNum=bahadata().get("nowADNum")||"";var sNuma=sNum.split(",",2);var d=new Date;var day=d.getDate();if(day!=sNuma[0]){return Math.floor(Math.random()*10+1)}else{return sNuma[1]}}function setnowNum(num){var d=new Date;var day=d.getDate();bahadata().set("nowADNum",day+","+num)}BAHA_AD.prototype.init=function(data){var self=this;if(/ip(hone|od|ad)/i.test(navigator.userAgent)){self.platform="iOS"}else{self.platform="Android"}self.nowNum=getnowNum();if(/hk/i.test(window.navigator.userLanguage||window.navigator.language)){self.area="HK"}else{self.area=""}self.ad=data};BAHA_AD.prototype.show=function(div){var self=this;if(typeof self.ad[self.platform+"__"]!="undefined"||typeof self.ad[self.platform+"_"+self.area+"_"]!="undefined"){if(typeof self.ad[self.platform+"_"+self.area+"_"]!="undefined"&&0!=self.ad[self.platform+"_"+self.area+"_"].length){var showad=self.ad[self.platform+"_"+self.area+"_"][self.nowNum%self.ad[self.platform+"_"+self.area+"_"].length]}else{var showad=self.ad[self.platform+"__"][self.nowNum%self.ad[self.platform+"__"].length]}egg("#"+div).css("text-align","center");egg("#"+div).html('<a href="'+showad["link"]+'" target="_blank"><img onload="Mobile.Ad.antiBlock(\''+div+'\');" src="'+showad["pic"]+'" width="100%"></a>');ga("adTracker.send","event",showad["position"],showad["schedule"]);self.nowNum=parseInt(self.nowNum)+1;setnowNum(self.nowNum)}};if(typeof exports=="object"){module.exports=BAHA_AD}else if(typeof define=="function"&&define.amd){define(function(){return BAHA_AD})}else{window.BAHA_AD=BAHA_AD}})(window,window.document);function MB_forum_commend_delPre(bsn,snB,del){if(""==del){alert("你必須要選擇你要刪除的推文");return false}egg.ajax({url:"/ajax/MB_forum_commend_del1.php",method:"POST",param:"bsn="+bsn+"&snB="+snB+"&del[]="+del,success:function(jsondoc){var jsonda=JSON.parse(jsondoc);if(jsonda.errMsg){alert(jsonda.errMsg)}else{MB_forum_commend_del(bsn,snB,del,jsonda.codes)}}})}function MB_forum_commend_del(bsn,snB,del,codes){if(confirm("確定要刪除這則留言？")){if(""==del){alert("你必須要選擇你要刪除的推文。");return false}egg.ajax({url:"/ajax/MB_forum_commend_del2.php",method:"POST",param:"bsn="+bsn+"&snB="+snB+"&del[]="+del+"&code="+codes,success:function(jsondoc){var jsonda=JSON.parse(jsondoc);if(jsonda.errMsg){alert(jsonda.errMsg)}else{if("object"===typeof jsonda[del]){egg("#Commendcontent_"+del).html('<a href="/home/home.php?owner='+jsonda[del].user+'">'+jsonda[del].nick+"：</a><span>"+jsonda[del].time+"</span><p>"+jsonda[del].commend+"</p>")}}}})}}function MB_forum_commend_new(bsn,snB,btn){if(""==egg.cookie.get("MB_BAHAID")||"guest"==egg.cookie.get("MB_BAHAID")){location.href="https://user.gamer.com.tw/login.php";return false}var txt=egg("#commendReply_"+snB).val();if(txt.match(/^[ 　\n]+$/)||txt===""){alert("請填留言內容");return false}if(btn){btn.disabled=true}MB_getCSRFToken().done(function(token){var param={bsn:bsn,snB:snB,c:txt,token:token};jQuery.ajax({url:"/ajax/MB_forum_commend_new.php",data:param,method:"POST",dataType:"text"}).done(function(rdata){if("NOLOGIN"==rdata){alert("您尚未登入");location.href="https://user.gamer.com.tw/login.php";return false}else if("ERROR:"==rdata.substr(0,6)){alert(rdata.substr(6));return false}ga("send","event","互動","哈啦區","留言");var listSelector="#commendlist_"+snB;jQuery(rdata).appendTo(listSelector);Mobile.Forum.commentFormatter(listSelector+" .cbox_msg2_list p");egg("#commendReply_"+snB).val("")})});return false}function MB_forum_commend_all(bsn,snB){if(morecommendloading){return false}morecommendloading=true;egg("#commendlist_"+snB).html('<img width="60px" src="https://i2.bahamut.com.tw/loadingBar.gif">');egg.ajax({url:"/ajax/MB_forum_commend_all.php",param:"bsn="+bsn+"&snB="+snB,method:"GET",success:function(rdata){morecommendloading=false;var listSelector="#commendlist_"+snB;jQuery(listSelector).html(rdata);Mobile.Forum.commentFormatter(listSelector+" .cbox_msg2_list p")}})}$.urlParam=function(name){var results=new RegExp("[?&]"+name+"=([^&#]*)").exec(window.location.href);if(results==null){return null}else{return decodeURI(results[1])||0}};var BH_AlkasooD=function(jq){function toCode62(n){var code62Map=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return code62Map[n]}function fromCode62(code){if(code=="-"){return-1}var n=code.charCodeAt(0);if(n>=48&&n<=57){n-=48}else if(n>=65&&n<=90){n-=55}else if(n>=97&&n<=122){n-=61}else{n=-1}return n}function generateCkGamerAdString(ck,cookiePos,adIndex){var CK_GAMER_AD_LENGTH=25;var ckStr=ck,i;if(ck==""){for(i=0;i<CK_GAMER_AD_LENGTH;i++){ckStr+="-"}}ckStr=ckStr.substring(0,cookiePos)+toCode62(adIndex)+ckStr.substring(cookiePos+1);return escape(ckStr)}var bahaADnum=egg.cookie.get("ckBahaAd");var setflagc=false;var setflagc2=false;var oo={};jq("a.a-mercy-d").each(function(){var info=jq(this).data("mercy");if(info){var str=info.split(":");if(str[0]&&str[1]){str[0]=parseInt(str[0],10);str[1]=parseInt(str[1],10);bahaADnum=generateCkGamerAdString(bahaADnum,str[0],str[1]);setflagc=true}}var info2=jq(this).data("si");if(info2){var str=info2.split(":");var pos=str[0];if(typeof str[1]!=="undefined"){var s2=str[1].split(",");jq.each(s2,function(i,v){var vvv=v.split("_");jq.extend(true,oo,JSON.parse('{"'+pos+'":{"'+vvv[0]+'":"'+vvv[1]+'"}}'));setflagc2=true})}}});if(setflagc2){var bahaAD2str=egg.cookie.get("ckBAHAADS");if(!bahaAD2str){document.cookie="ckBAHAADS="+JSON.stringify(oo)+";path=/;expires="+(new Date).toDateString()+" 23:59:59 UTC+0800;domain=.gamer.com.tw"}else{var adlist=JSON.parse(bahaAD2str);jq.extend(true,adlist,oo);document.cookie="ckBAHAADS="+JSON.stringify(adlist)+";path=/;expires="+(new Date).toDateString()+" 23:59:59 UTC+0800;domain=.gamer.com.tw"}}if(setflagc){document.cookie="ckBahaAd="+bahaADnum+";path=/;expires="+(new Date).toDateString()+" 23:59:59 UTC+0800;domain=.gamer.com.tw"}};function resizeImage(resizeTo){jQuery(".home_box img").load(function(){let dprWidth=Math.min(Math.round(window.devicePixelRatio),3);let img=jQuery(this);if(img.attr("srcset")&&img.attr("srcset").split(",")[1]!=undefined){if(img.width()&&img.width()*dprWidth>resizeTo&&img.parents("table").length==0||img.parents("table").length!=0&&img.width()*dprWidth>=img.parents("td").width()){img.width("100%")}else{img.width(img.width()*dprWidth+"px")}}else if(img.width()&&img.width()>resizeTo||img.parents("table").length!=0&&img.width()>=img.parents("td").width()){img.width("100%")}})}